{% extends "base.html" %}

{% block title %}Chi ti·∫øt Challenge{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="card mb-4">
                <div class="card-header bg-info text-white">
                    <h4 class="mb-0">üìã {{ challenge.title }}</h4>
                </div>
                <div class="card-body">
                    <p class="mb-2">{{ challenge.description or 'Kh√¥ng c√≥ m√¥ t·∫£' }}</p>
                    
                    {% if challenge.hint %}
                    <div class="alert alert-warning mt-3">
                        <h5 class="mb-2">üí° G·ª£i √Ω cho sinh vi√™n:</h5>
                        <p class="mb-0">{{ challenge.hint }}</p>
                    </div>
                    {% endif %}
                    
                    <div class="row mt-3">
                        <div class="col-md-4">
                            <p class="mb-1"><small><strong>Gi√°o vi√™n:</strong> {{ challenge.teacher.fullname }}</small></p>
                        </div>
                        <div class="col-md-4">
                            <p class="mb-1"><small><strong>Ng√†y t·∫°o:</strong> {{ challenge.created_at.strftime('%d/%m/%Y %H:%M') }}</small></p>
                        </div>
                        <div class="col-md-4">
                            <p class="mb-1"><small><strong>Tr·∫°ng th√°i:</strong> 
                                {% if challenge.is_active %}
                                <span class="badge bg-success">ƒêang ho·∫°t ƒë·ªông</span>
                                {% else %}
                                <span class="badge bg-secondary">ƒê√£ v√¥ hi·ªáu h√≥a</span>
                                {% endif %}
                            </small></p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mb-4 border-danger">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0">üîë ƒê√°p √°n (Ch·ªâ gi√°o vi√™n th·∫•y)</h5>
                </div>
                <div class="card-body">
                    <h3 class="text-danger mb-2">{{ challenge.get_answer() }}</h3>
                    <p class="mb-0 text-muted">ƒê√°p √°n ƒë∆∞·ª£c l·∫•y t·ª´ t√™n file (kh√¥ng c√≥ ph·∫ßn m·ªü r·ªông .txt)</p>
                </div>
            </div>

            <div class="card mb-4">
                <div class="card-header bg-dark text-white">
                    <h5 class="mb-0">üìñ N·ªôi dung file</h5>
                </div>
                <div class="card-body">
                    <div class="bg-light p-4 rounded" style="white-space: pre-wrap; font-family: 'Courier New', monospace; line-height: 1.8;">{{ content }}</div>
                </div>
            </div>
            
            <div class="text-center">
                <a href="{{ url_for('challenge.list_challenges') }}" class="btn btn-primary">
                    ‚¨ÖÔ∏è Quay l·∫°i danh s√°ch
                </a>
                {% if challenge.is_active %}
                <form method="POST" action="{{ url_for('challenge.deactivate', challenge_id=challenge.id) }}" style="display: inline;">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <button type="submit" class="btn btn-warning" onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën v√¥ hi·ªáu h√≥a challenge n√†y?')">
                        üö´ V√¥ hi·ªáu h√≥a
                    </button>
                </form>
                {% endif %}
                <form method="POST" action="{{ url_for('challenge.delete', challenge_id=challenge.id) }}" style="display: inline;">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <button type="submit" class="btn btn-danger" onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a challenge n√†y? H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c!')">
                        üóëÔ∏è X√≥a
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
